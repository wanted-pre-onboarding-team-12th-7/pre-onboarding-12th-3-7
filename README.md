# í”„ë¦¬ì˜¨ë³´ë”© 7íŒ€ Search Clinical Trial

![logo](https://github.com/wanted-pre-onboarding-team-12th-7/pre-onboarding-12th-3-7/assets/52682692/8c1d916a-2d12-41ee-9f2d-bced871a7d97)

7íŒ€ì˜ í˜‘ì—…ì€ ì´ë ‡ê²Œ ì§„í–‰ë˜ê³  ìˆì–´ìš”! [ê¶ê¸ˆí•˜ë‹¤ë©´ í´ë¦­!](https://www.notion.so/sonicrok/7-5fcce41bb3594680b16862082dd0324d)

## í”„ë¡œì íŠ¸ ì†Œê°œ

ì›í‹°ë“œ í”„ë¦¬ì˜¨ë³´ë”© í”„ë¡ íŠ¸ì—”ë“œ - 3ì£¼ì°¨ ê³¼ì œ ë‚´ìš©ì„ êµ¬í˜„í•œ Search Clinical Trial í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤!

[ëª©í‘œ] [í•œêµ­ì„ìƒì •ë³´](https://clinicaltrialskorea.com/) í´ë¡ í•˜ì—¬ ê²€ìƒ‰ ë° ìºì‹± ê¸°ëŠ¥ì„ êµ¬í˜„í•œ ì›¹ ì‚¬ì´íŠ¸ êµ¬ì¶•

## íŒ€ì› ì†Œê°œ

| <img src="https://avatars.githubusercontent.com/wisdomin121" width="130" height="130"> | <img src="https://avatars.githubusercontent.com/anyl92" width="130" height="130"> | <img src="https://avatars.githubusercontent.com/SeungrokYoon" width="130" height="130"> | <img src="https://avatars.githubusercontent.com/5unk3n" width="130" height="130"> | <img src="https://avatars.githubusercontent.com/salmontaker" width="130" height="130"> | <img src="https://avatars.githubusercontent.com/JangHyunjeong" width="130" height="130"> |
| :------------------------------------------------------------------------------------: | :-------------------------------------------------------------------------------: | :-------------------------------------------------------------------------------------: | :-------------------------------------------------------------------------------: | :------------------------------------------------------------------------------------: | :--------------------------------------------------------------------------------------: |
|                                       **ê¹€ë¯¼ì§€**                                       |                                 **ì•ˆìœ ë¦¼ (ì„œê¸°)**                                 |                                    **ìœ¤ìŠ¹ë¡ (ì„œê¸°)**                                    |                                    **ì´ì„ ê·¼**                                     |                                   **ì´ìŠ¹ì› (íŒ€ì¥)**                                    |                                        **ì¥í˜„ì •**                                        |
|                     [@wisdomin121](https://github.com/wisdomin121)                     |                       [@anyl92](https://github.com/anyl92)                        |                    [@SeungrokYoon](https://github.com/SeungrokYoon)                     |                       [@5unk3n](https://github.com/5unk3n)                        |                     [@salmontaker](https://github.com/salmontaker)                     |                    [@JangHyunjeong](https://github.com/JangHyunjeong)                    |

## ê°œë°œ í™˜ê²½

### Developement

<img src="https://img.shields.io/badge/Node.js v18 (LTS)-grey?style=for-the-badge&logo=nodedotjs"> <img src="https://img.shields.io/badge/React-61DAFB?style=for-the-badge&logo=React&logoColor=white"/> <img src="https://img.shields.io/badge/TypeScript-3178C6?style=for-the-badge&logo=TypeScript&logoColor=white"/>

### Convention

<img src="https://img.shields.io/badge/husky-brown?style=for-the-badge&logo=npm"> <img src="https://img.shields.io/badge/lint staged-white?style=for-the-badge&logo=npm"> <img src="https://img.shields.io/badge/ESLint-4B32C3?style=for-the-badge&logo=eslint"> <img src="https://img.shields.io/badge/Prettier-F7B93E?style=for-the-badge&logo=prettier&logoColor=white">

### Network & Route

<img src="https://img.shields.io/badge/React Router-CA4245?style=for-the-badge&logo=React Router&logoColor=white"> <img src="https://img.shields.io/badge/Axios-5A29E4?style=for-the-badge&logo=Axios&logoColor=white"/>

### Styling

<img src="https://img.shields.io/badge/styled component-DB7093?style=for-the-badge&logo=styled-components&logoColor=white"/>

## í”„ë¡œì íŠ¸ ì‹¤í–‰ ë°©ë²•

ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ í”„ë¡œì íŠ¸ë¥¼ clone í•˜ì‹œê±°ë‚˜ (gitì´ ì„¤ì¹˜ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.)

ìš°ì¸¡ ìƒë‹¨ì˜ `Code` ë²„íŠ¼ -> `Download ZIP` ë¥¼ ëˆŒëŸ¬ í”„ë¡œì íŠ¸ë¥¼ ë‹¤ìš´ë¡œë“œ í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```shell
git clone https://github.com/wanted-pre-onboarding-team-12th-7/pre-onboarding-12th-3-7.git
```

í”„ë¡œì íŠ¸ ë‹¤ìš´ë¡œë“œê°€ ëë‚¬ë‹¤ë©´, í•´ë‹¹ ë””ë ‰í† ë¦¬ë¡œ ì´ë™í•˜ì—¬ í”„ë¡œì íŠ¸ ì‹¤í–‰ì— í•„ìš”í•œ íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤.

```shell
npm install
```

íŒ¨í‚¤ì§€ ì„¤ì¹˜ê°€ ëë‚¬ë‹¤ë©´, ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ í”„ë¡œì íŠ¸ë¥¼ ì‹¤í–‰í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤!

```shell
npm start
```

## ë°°í¬ ë§í¬

ë°°í¬ ë§í¬: https://pre-onboarding-12th-3-7.vercel.app/

ë°°í¬ëŠ” `vercel` ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.

## ì•„í‚¤í…ì³

### ë””ë ‰í† ë¦¬ êµ¬ì¡°

```
ğŸ“¦src
 â”£ ğŸ“‚apis
 â”£ ğŸ“‚assets
 â”ƒ â”— ğŸ“‚svg
 â”£ ğŸ“‚components
 â”ƒ â”— ğŸ“‚Search
 â”£ ğŸ“‚hooks
 â”£ ğŸ“‚pages
 â”£ ğŸ“‚store
 â”£ ğŸ“‚styles
 â”ƒ â”£ ğŸ“‚base
 â”ƒ â”— ğŸ“‚constants
```

# Best Practice ë…¼ì˜

## 1. ì§ˆí™˜ëª… ê²€ìƒ‰ì‹œ API í˜¸ì¶œ í†µí•´ì„œ ê²€ìƒ‰ì–´ ì¶”ì²œ ê¸°ëŠ¥ êµ¬í˜„

### 1-1. API í˜¸ì¶œ ì˜ì—­ì„ custom hookìœ¼ë¡œ ë¶„ë¦¬í•˜ì—¬ ì¶”ìƒí™”

- ì¶”ì²œ ê²€ìƒ‰ì–´ë¥¼ ë…¸ì¶œ í•˜ëŠ” `SearchSuggestion`ì»´í¬ë„ŒíŠ¸ì—ì„œëŠ” API í˜¸ì¶œì˜ ê²°ê³¼ ê°’ë§Œ í•„ìš”í•˜ë‹¤ê³  ë…¼ì˜ë˜ì—ˆìŠµë‹ˆë‹¤.
  `suggestions(ì¶”ì²œ ê²€ìƒ‰ì–´), loading(ë¡œë”© ì—¬ë¶€), error(ì—ëŸ¬ ì—¬ë¶€)` ë§Œ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë„ë¡, APIë¥¼ í˜¸ì¶œë¶€ë¥¼ custom hookìœ¼ë¡œ ë¶„ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤.

- ë¶„ë¦¬ëœ `useSuggestions` hookì€ `keyword`ë¥¼ ì£¼ì…í•  ìˆ˜ ìˆë„ë¡ ì œì‘í–ˆê³  `useEffect`ë¥¼ ì‚¬ìš©í•˜ì—¬ keywordì˜ ìƒíƒœì— ë”°ë¼ returnë  ê°’ë“¤ì˜ ìƒíƒœë¥¼ ë³€ê²½í•´ ì£¼ì—ˆìŠµë‹ˆë‹¤.

```ts
const useSuggestions = (keyword: string) => {
  ...
  useEffect(() => {
  ...
  }, [keyword])

  return { suggestions, loading, error }
}
```

### 1-2. useSuggestions êµ¬í˜„ ë°©ë²•

**1). loading**

- `default ê°’ì„ false`ë¡œ ì„¤ì •í•˜ì˜€ê³ , `keyword !== ''`ì¸ ê²½ìš° `true`, `finally`ë¥¼ ì‚¬ìš©í•˜ì—¬ APIí˜¸ì¶œ ì™„ë£Œì‹œ `false` ê°’ì„ return í•˜ì˜€ìŠµë‹ˆë‹¤.

**2). error**

- `default ê°’ì„ false`ë¡œ ì„¤ì •í•˜ì—¬ APIí˜¸ì¶œ ì‹¤íŒ¨ ì‹œ, `true` ê°’ì„ return í•˜ì˜€ìŠµë‹ˆë‹¤.

**3). suggestions**

- ì €ì¥ ëœ `cache data`ê°€ ìˆìœ¼ë©´ `cache`ì— ì €ì¥ëœ dataë¥¼ return í•´ì£¼ì—ˆìŠµë‹ˆë‹¤.
- ì €ì¥ ëœ `cache data`ê°€ ì—†ìœ¼ë©´ `suggestionAPI`ë¡œ í˜¸ì¶œëœ dataë¥¼ return í•´ì£¼ì—ˆìŠµë‹ˆë‹¤.

```ts
// src/hooks/useSuggestions.ts

const [loading, setLoading] = useState<boolean>(false)
const [error, setError] = useState<boolean>(false)

useEffect(() => {
  if (keyword !== '') {
  setLoading(true)

  const cache = cacheRepository.get(keyword)

  if (cache && cache.expireTime > Date.now()) {
    setSuggestions(cache.data)
    setLoading(false)
  } else {
    suggestionAPI
      .get(keyword)
      .then((res) => {
        setSuggestions(res.data)
        cacheRepository.set(keyword, res.data)
      })
      .catch(() => setError(true))
      .finally(() => {
        setLoading(false)
      })
    }
  } else {
    setSuggestions([])
  }
}, [keyword])
```

### 1-3. ê²€ìƒ‰ì°½ ì»´í¬ë„ŒíŠ¸ ì„¤ê³„

- ì•ì„œ ì •ì˜ëœ `useSuggestions` hookì„ ì´ìš©í•˜ì—¬ `suggestions, loading, error`ì„¸ ìƒíƒœì˜ ê²°ê³¼ê°’ì„ í™”ë©´ì— ì¶œë ¥í–ˆìŠµë‹ˆë‹¤.

```
const { suggestions, loading, error } = useSuggestions(debouncedValue)
```

- `loading / error` ì—¬ë¶€ì— ë”°ë¼ `loading / error message`ë¥¼ ì¶œë ¥í•´ ì£¼ì—ˆìŠµë‹ˆë‹¤.

- `suggestions.length === 0`ì˜ ì°¸/ê±°ì§“ì— ë”°ë¼ `'ìµœê·¼ ê²€ìƒ‰ì–´ + ì¶”ì²œ ê²€ìƒ‰ì–´(default)' / 'ì¶”ì²œ ê²€ìƒ‰ì–´(suggestions)'`ê°’ì„ ì¶œë ¥í•´ì£¼ì—ˆìŠµë‹ˆë‹¤.

```tsx
// src/components/search/SearchSuggestion.tsx

{loading ? (
  <S.SearchMainText>ê²€ìƒ‰ ì¤‘ ...</S.SearchMainText>
) : error ? (
  <S.SearchMainText>ê²€ìƒ‰ ì—ëŸ¬ ë°œìƒ, ë¬¸ì˜ ë¶€íƒë“œë¦½ë‹ˆë‹¤.</S.SearchMainText>
) : (
  <>
    <S.SearchRecentBox>
      {suggestions.length === 0 ? (
        <>
          <S.SearchMainText>ìµœê·¼ ê²€ìƒ‰ì–´</S.SearchMainText>
          <div>ìµœê·¼ ê²€ìƒ‰ì–´ê°€ ì—†ìŠµë‹ˆë‹¤</div>
        </>
        ) : (
          <S.SearchRecentItemList>
          ...
          <S.SearchMainText>ì¶”ì²œ ê²€ìƒ‰ì–´</S.SearchMainText>
          {suggestions.map((suggestion: SickObj, index) => {
            return (
              <S.SearchRecentItem
                key={suggestion.sickCd}
                $selectIndex={selectIndex === index + 1}
              >
              ...
              </S.SearchRecentItem>
            )
          })}
          </S.SearchRecentItemList>
        )}
    </S.SearchRecentBox>
      {suggestions.length === 0 && (
        <>
          <S.SearchMainText>ì¶”ì²œ ê²€ìƒ‰ì–´ë¡œ ê²€ìƒ‰í•´ë³´ì„¸ìš”</S.SearchMainText>
          <S.SearchSuggestionBox>
          <S.SearchSuggestionItem>Bí˜•ê°„ì—¼</S.SearchSuggestionItem>
            ...
          </S.SearchSuggestionBox>
        </>
      )}
  </>
)}
```

## 2. API í˜¸ì¶œ ë³„ ë¡œì»¬ ìºì‹± êµ¬í˜„

### 2-1. ìºì‹œë¥¼ ì–´ë””ì— ì €ì¥í•´ì•¼ í•˜ëŠ”ê°€?

> íŒ€ì›ë“¤ ëª¨ë‘ì˜ ì˜ê²¬ì´ ì¡°ê¸ˆì”© ë‹¬ëìœ¼ë‚˜, ê° ë°©ë²•ì˜ ì¥ë‹¨ì ì„ ë¹„êµí•´ë³´ë©° í•˜ë‚˜ì˜ Best Practiceë¡œ í†µí•©í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤!
>
> **1) LocalStorage** <br />
> ê²€ìƒ‰ì–´ ê¸°ë¡ì„ ë‚¨ê¸¸ ê²ƒì´ë¼ë©´ localStorageë¥¼ ì‚¬ìš©í•˜ëŠ”ê²Œ ë§ìœ¼ë‚˜, ê²€ìƒ‰ì–´ì˜ ê²°ê³¼ë¥¼ ë¸Œë¼ìš°ì €ê°€ ë‹«í˜€ë„ ì €ì¥í•  í•„ìš”ëŠ” ì—†ë‹¤ ìƒê°í•˜ì—¬ localStorageëŠ” ì„ íƒì§€ì—ì„œ ì œì™¸í•˜ì˜€ìŠµë‹ˆë‹¤.
>
> **2) SessionStorage** <br />
> localStorageì™€ sessionStorageì—ëŠ” ë¬¸ìì—´ë§Œ ì €ì¥ì´ ê°€ëŠ¥í•˜ë¯€ë¡œ, ìºì‹œë¥¼ ì €ì¥í•˜ê³  ë¶ˆëŸ¬ì˜¤ëŠ” ê³¼ì •ì—ì„œ JSON.stringifyë¡œ ì§ë ¬í™” í•˜ëŠ” ë¹„ìš©ì´ ë“¤ê¸° ë•Œë¬¸ì— ì„ íƒì§€ì—ì„œ ì œì™¸í•˜ì˜€ìŠµë‹ˆë‹¤.
>
> **3) CacheStorage** <br />
> cacheStorageì˜ ì‚¬ìš©ì„ ì‹œë„í•´ë³¸ íŒ€ì›ì´ ìˆì—ˆìœ¼ë‚˜, expireTime ì‚½ì…ì— ì´ìŠˆê°€ ìˆì—ˆë‹¤ê³  í•˜ì—¬ ì„ íƒì§€ì—ì„œ ì œì™¸í•˜ì˜€ìŠµë‹ˆë‹¤.
>
> **4) Memory** <br />
> ë”°ë¼ì„œ, ê°ì²´ í˜•íƒœë¡œ ë©”ëª¨ë¦¬ì— ì§ì ‘ ìºì‹œë¥¼ ì €ì¥í•˜ê¸°ë¡œ ê²°ì •í•˜ì˜€ìŠµë‹ˆë‹¤.

### 2-2. ìºì‹œë¥¼ ì–´ë–»ê²Œ ì €ì¥í•  ê²ƒì¸ê°€?

```ts
// src/store/CacheRepository.ts

interface LocalCache<T> {
  data: T[]
  expireTime: number
}

const MINUTES_IN_MILLISECONDS = 60000
const EXPIRE_TIME = MINUTES_IN_MILLISECONDS * 1

export class CacheRepository<T> {
  #cache: Record<string, LocalCache<T>> = {}

  set(key: string, value: T[]) {
    this.#cache[key] = {
      data: value,
      expireTime: Date.now() + EXPIRE_TIME,
    }
  }

  get(key: string) {
    return this.#cache[key]
  }
}
```

key: ê²€ìƒ‰ì–´ <br/>
value: ì¶”ì²œ ê²€ìƒ‰ì–´, ìºì‹œ ë§Œë£Œì‹œê°„ <br/>
ë‹¤ìŒê³¼ ê°™ì€ ê°ì²´ í˜•íƒœë¡œ ìºì‹œë¥¼ ì €ì¥í•˜ì˜€ìŠµë‹ˆë‹¤.

### 2-3. ìºì‹œë¥¼ ì €ì¥í•˜ëŠ” ì£¼ì²´ëŠ” ëˆ„ê°€ ë˜ì–´ì•¼ í•˜ëŠ”ê°€?

```ts
// src/hooks/useSuggestions.ts

useEffect(() => {
  if (keyword !== '') {
    setLoading(true)

    const cache = cacheRepository.get(keyword)

    if (cache && cache.expireTime > Date.now()) {
      setSuggestions(cache.data)
      setLoading(false)
    } else {
      suggestionAPI
        .get(keyword)
        .then((res) => {
          setSuggestions(res.data)
          cacheRepository.set(keyword, res.data)
        })
        .catch(() => setError(true))
        .finally(() => {
          setLoading(false)
        })
    }
  } else {
    setSuggestions([])
  }
}, [keyword])
```

ì²˜ìŒì—ëŠ” ì¶”ì²œ ê²€ìƒ‰ì–´ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì»¤ìŠ¤í…€ í›…ì¸ [useSuggestions ë‚´ë¶€ì—ì„œ ìºì‹œì˜ ìœ íš¨ì„±ì„ ê²€ì‚¬í•˜ê³ , ì €ì¥](https://github.com/wanted-pre-onboarding-team-12th-7/pre-onboarding-12th-3-7/pull/12)í•˜ì˜€ìŠµë‹ˆë‹¤. <br />
í•˜ì§€ë§Œ useSuggestions ì˜ ê´€ì‹¬ì‚¬ëŠ” ì¶”ì²œëª©ë¡ì„ ê°€ì ¸ì˜¤ëŠ” ê²ƒê³¼Â ë¡œë”©ê³¼ ì—ëŸ¬ì˜ íŒë‹¨ì…ë‹ˆë‹¤. <br />
ìºì‹œì˜ ìœ ë¬´ì™€ ë§Œë£Œí™•ì¸,Â ìºì‹œì˜ ì €ì¥ê¹Œì§€ëŠ” [í•´ë‹¹ ì»¤ìŠ¤í…€ í›…ì˜ ê´€ì‹¬ì‚¬ê°€ ì•„ë‹ˆë¼ê³  ìƒê°](https://github.com/wanted-pre-onboarding-team-12th-7/pre-onboarding-12th-3-7/issues/14)í•˜ì˜€ìŠµë‹ˆë‹¤. <br />

```ts
// src/apis/suggestion.ts

const cacheRepository = new CacheRepository<SickObj>()

const getSuggestion = async (searchTerm: string) => {
  const cache = cacheRepository.get(searchTerm)

  if (cache && cache.expireTime > Date.now()) {
    return cache.data
  } else {
    const { data } = await instance.get<GetSuggestionResponse>('sick', { q: searchTerm })
    cacheRepository.set(searchTerm, data)

    return data
  }
}
```

ë”°ë¼ì„œ, ì¶”ì²œëª©ë¡ì„ ì„œë²„ì—ì„œ ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜ì¸ [getSuggestionì—ì„œ ìºì‹± ë¡œì§ì„ ìˆ˜í–‰í•˜ë„ë¡ ë³€ê²½](https://github.com/wanted-pre-onboarding-team-12th-7/pre-onboarding-12th-3-7/pull/15) í•˜ì˜€ìŠµë‹ˆë‹¤. <br />
getSuggestionì—ì„œëŠ”, ì¶”ì²œ ê²€ìƒ‰ì–´ë¥¼ ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜ í˜¸ì¶œì‹œ ë‹¤ìŒì˜ ë™ì‘ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.

- í•´ë‹¹ ê²€ìƒ‰ì–´ì— ëŒ€í•œ ìºì‹œê°€ ì¡´ì¬í•˜ê³ , expireTimeì´ ì§€ë‚˜ì§€ ì•Šì•˜ìœ¼ë©´ ìºì‹œì— ì €ì¥ëœ ê°’ì„ ë°˜í™˜í•¨
- í•´ë‹¹ ê²€ìƒ‰ì–´ì— ëŒ€í•œ ìºì‹œê°€ ì¡´ì¬í•˜ì§€ ì•Šê±°ë‚˜, expireTimeì´ ì§€ë‚¬ìœ¼ë©´, ì„œë²„ì— í•´ë‹¹ ê²€ìƒ‰ì–´ë¡œ ìš”ì²­ì„ ë³´ë‚¸ í›„ ê²°ê³¼ê°’ì„ ìºì‹œì— ì €ì¥í•˜ê³  ë°˜í™˜í•¨

## 3. ì…ë ¥ë§ˆë‹¤ API í˜¸ì¶œí•˜ì§€ ì•Šë„ë¡ API í˜¸ì¶œ íšŸìˆ˜ë¥¼ ì¤„ì´ëŠ” ì „ëµ ìˆ˜ë¦½ ë° ì‹¤í–‰

### 3-1. useDebounce hookì„ í†µí•´ ë§¤ ì…ë ¥ë§ˆë‹¤ í˜¸ì¶œ ë°©ì§€

ë…¼ì˜ì—ì„œëŠ” `useDeferredValue`ì™€ `useDebounce` ë‘ ê°€ì§€ ë°©ë²•ì— ëŒ€í•œ ì˜ê²¬ì´ ë‚˜ì™”ìŠµë‹ˆë‹¤.

ê°„ë‹¨í•˜ê²Œ ì„¤ëª…í•´ë³´ìë©´,
useDeferredValueëŠ” `ë¹„ë™ê¸°` ì‘ì—…ì˜ ê²°ê³¼ë¥¼ ì§€ì—°ì‹œì¼œì„œ, ë¦¬ì†ŒìŠ¤ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ í™œìš©í•˜ê³ , í™”ë©´ì´ ë¶€ë“œëŸ½ê²Œ ì—…ë°ì´íŠ¸ ë  ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ê³ ,
useDebounceëŠ” ì‚¬ìš©ìì˜ ì…ë ¥ì„ í™•ì¸í•´ ì…ë ¥ì´ ì—°ì†ì ìœ¼ë¡œ ë°œìƒí•  ë•Œ delay ë™ì•ˆ ì…ë ¥ì„ `ë¬´ì‹œ`í•˜ë‹¤ê°€ delayê°€ ì§€ë‚˜ë©´ ë°˜ì˜ì‹œì¼œì¤ë‹ˆë‹¤.

useDeferredValueë¥¼ ì‚¬ìš©í•œë‹¤ë©´ UX ì¸¡ë©´ì—ì„œëŠ” ì¢‹ì€ ê²°ê³¼ë¥¼ ë³´ì˜€ê² ì§€ë§Œ,
ê³¼ì œì—ì„œ ì œì‹œí•œ `API í˜¸ì¶œ íšŸìˆ˜ ì¤„ì´ê¸°`ì—ì„œëŠ” useDebounceê°€ ë” ì ì ˆí•˜ë‹¤ê³  íŒë‹¨ë˜ì–´ ìµœì¢…ì ìœ¼ë¡œ `useDebounce`ë¥¼ í†µí•´ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.

### 3-2. useDebounce êµ¬í˜„ ë°©ë²•

- `useDebounce`ë¡œ ë¶„ë¦¬
- íŒŒë¼ë¯¸í„° : value(string), delay(number)

apië¥¼ í˜¸ì¶œí•´ ê²°ê³¼ê°’(=suggestions)ì„ ë¦¬í„´í•´ì£¼ëŠ” `useSuggestions` ì»¤ìŠ¤í…€ í›…ì„ ì œì‘í•˜ì˜€ìŠµë‹ˆë‹¤.

```ts
// src/hooks/useSuggestions.ts

const useSuggestions = (keyword: string) => {
  const [suggestions, setSuggestions] = useState<SickObj[]>([])
  const [loading, setLoading] = useState<boolean>(false)
  const [error, setError] = useState<boolean>(false)

  useEffect(() => {
    if (keyword !== '') {
      setLoading(true)

      suggestionAPI
        .get(keyword)
        .then((res) => {
          setSuggestions(res.data)
        })
        .catch(() => setError(true))
        .finally(() => {
          setLoading(false)
        })
    } else {
      setSuggestions([])
    }
  }, [keyword])

  return { suggestions, loading, error }
}
```

íŒŒë¼ë¯¸í„°ë¡œ ë“¤ì–´ì˜¨ valueë¥¼ ì¼ì • ì‹œê°„(=delay)ì´ ì§€ë‚˜ë©´ ë‹¤ì‹œ ë¦¬í„´ì‹œì¼œì£¼ëŠ” `useDebounce` ì»¤ìŠ¤í…€ í›…ì„ ì œì‘í•˜ì˜€ìŠµë‹ˆë‹¤.

```ts
// src/hooks/useDebounce.ts

const useDebounce = (value: string, delay: number) => {
  const [debouncedValue, setDebouncedValue] = useState(value)

  useEffect(() => {
    const timer = setTimeout(() => {
      setDebouncedValue(value)
    }, delay)

    return () => clearTimeout(timer)
  }, [value])

  return debouncedValue
}
```

ê²°ê³¼ì ìœ¼ë¡œ useSuggestions í›…ì—ëŠ” useDebounce í›…ìœ¼ë¡œ delay ëœ keywordê°€ ë“¤ì–´ê°€ê²Œ ë©ë‹ˆë‹¤.

```ts
// src/pages/MainPage.tsx

const debouncedValue = useDebounce(keyword, DEBOUNCE_DELAY)
const { suggestions, loading, error } = useSuggestions(debouncedValue)
```

## 4. í‚¤ë³´ë“œë§Œìœ¼ë¡œ ì¶”ì²œ ê²€ìƒ‰ì–´ë“¤ë¡œ ì´ë™ ê°€ëŠ¥í•˜ë„ë¡ êµ¬í˜„

### 4-1. focusë¥¼ ì–´ë””ì—ì„œ ê´€ë¦¬í•  ê²ƒì¸ê°€?

- ì¶”ì²œ ê²€ìƒ‰ì–´ ìš”ì†Œì— ì§ì ‘ focusë¥¼ ì´ë™ í•˜ëŠ” ë°©ë²•
- focusëŠ” inputì— ìœ ì§€í•œ ì±„ ì„ íƒ ìš”ì†Œì— ìŠ¤íƒ€ì¼ì„ ì ìš©í•´ focusëœ ê²ƒ ì²˜ëŸ¼ ë³´ì´ê²Œ í•˜ëŠ” ë°©ë²•

í•´ë‹¹ ê¸°ëŠ¥ êµ¬í˜„ì— ìˆì–´ íŒ€ì›ë“¤ê³¼ ìœ„ì˜ ë‘ ê°€ì§€ ì˜ê²¬ìœ¼ë¡œ ë…¼ì˜ë¥¼ í•˜ì˜€ìŠµë‹ˆë‹¤. <br />

focusë¥¼ ì§ì ‘ ì´ë™í•˜ëŠ” ë°©ë²•ì´ ì›¹ ì ‘ê·¼ì„± ì¸¡ë©´ì—ì„œ ì¢‹ì§€ë§Œ, ì¶”ì²œ ê²€ìƒ‰ì–´ë¥¼ íƒìƒ‰í•  ë•Œ ë™ì‹œì— ì…ë ¥ê°’ì„ ìˆ˜ì •í•  ìˆ˜ ì—†ë‹¤ëŠ” ë‹¨ì ì´ ìˆì—ˆìŠµë‹ˆë‹¤. <br />
ë”°ë¼ì„œ, ì¶”ì²œ ê²€ìƒ‰ì–´ íƒìƒ‰ ì¤‘ ëŠê¸°ì§€ ì•Šê³  ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•  ìˆ˜ ìˆëŠ” ê²ƒì´ ì‚¬ìš©ì ê²½í—˜ì— ë” ì¢‹ë‹¤ê³  íŒë‹¨í•´ inputì— focusë¥¼ ìœ ì§€í•˜ëŠ” ë°©ë²•ìœ¼ë¡œ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤. <br />

### 4-2. useKeyboardFocus êµ¬í˜„ ë°©ë²•

- onKeyDown ì´ë²¤íŠ¸ë¡œ ì¸ë±ìŠ¤ í•¸ë“¤ë§ <br />
- ë°©í–¥í‚¤ì™€ Tabí‚¤ë¥¼ ì‚¬ìš©í•´ ë„¤ë¹„ê²Œì´ì…˜ ë™ì‘ <br />
- ì ‘ê·¼ì„± ê³ ë ¤í•´ ul > li > button êµ¬ì¡°ë¡œ êµ¬í˜„

`KeyboardEvent`ê°€ ë°œìƒí•˜ë©´ keyì— ë”°ë¼ `currentIndex`ìƒíƒœë¥¼ ì¡°ì‘í•˜ëŠ” ì»¤ìŠ¤í…€ í›…ì„ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.

```ts
// src\hooks\useKeyboardFocus.ts

const [currentIndex, setCurrentIndex] = useState(-1)

...

const changeIndexByKeyDown = (e: React.KeyboardEvent) => {
  if (e.key === 'ArrowUp' || (e.shiftKey && e.key === 'Tab')) {
    moveToPrev(e);
  } else if (e.key === 'ArrowDown' || e.key === 'Tab') {
    moveToNext(e);
  } else if (e.key === 'Escape') {
    closeAndReset();
  }
};
```

mapí•¨ìˆ˜ì˜ indexì™€ ì„ íƒí•œ currentIndexë¥¼ ë¹„êµí•´ í˜„ì¬ ì„ íƒ ìš”ì†Œì— ìŠ¤íƒ€ì¼ì„ ì ìš©í•´ ì‚¬ìš©ìì—ê²Œ ì•Œë ¤ì¤ë‹ˆë‹¤.

```ts
// src\components\Search\SearchResult.tsx

suggestions.map((suggestion: SickObj, index) => {
  return (
    <S.SearchRecentItem
      key={suggestion.sickCd}
      $selectIndex={selectIndex === index + 1}
    >
      ...
    </S.SearchRecentItem>
  );
});
```

### 4-3. ì‚¬ìš© ë°©ë²•

> - `â†‘`, `Shift + Tab`: ì¶”ì²œ ê²€ìƒ‰ì–´ì˜ ì´ì „(ìœ„) ìš”ì†Œë¡œ ì´ë™í•©ë‹ˆë‹¤. ì²« ë²ˆì§¸ ìš”ì†Œì—ì„œ ì…ë ¥ ì‹œ ì¶”ì²œ ê²€ìƒ‰ì–´ ëª©ë¡ì„ ë‹«ìŠµë‹ˆë‹¤.
> - `â†“`: ì¶”ì²œ ê²€ìƒ‰ì–´ì˜ ë‹¤ìŒ(ì•„ë˜) ìš”ì†Œë¡œ ì„ íƒ ì´ë™í•©ë‹ˆë‹¤. ë§ˆì§€ë§‰ ìš”ì†Œì—ì„œ ì…ë ¥ ì‹œ ë™ì‘í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
> - `Tab`: ì¶”ì²œ ê²€ìƒ‰ì–´ì˜ ë‹¤ìŒ(ì•„ë˜) ìš”ì†Œë¡œ ì„ íƒ ì´ë™í•©ë‹ˆë‹¤. ë§ˆì§€ë§‰ ìš”ì†Œì—ì„œ ì…ë ¥ ì‹œ ëª©ë¡ì„ ë‹«ê³  DOM êµ¬ì¡°ìƒ ë‹¤ìŒì— ìˆëŠ” ìš”ì†Œë¥¼ focusí•©ë‹ˆë‹¤.
> - `esc`: ì¶”ì²œ ê²€ìƒ‰ì–´ ëª©ë¡ì„ ë‹«ìŠµë‹ˆë‹¤.
